# BMWVISION_V1

System wizualnej nawigacji oparty na analizie segmentacji obrazu i (opcjonalnie) danych GPS, sÅ‚uÅ¼Ä…cy do detekcji drogi, wizualizacji trajektorii oraz kierunku ruchu pojazdu.

## Opis projektu

Celem projektu jest stworzenie systemu, ktÃ³ry:
- Wykrywa drogÄ™ na nagraniu z kamery samochodowej przy uÅ¼yciu segmentacji obrazu (model **TwinLiteNetPlus**),
- Wyznacza trajektoriÄ™ jazdy na podstawie wykrytej maski drogi (aktualnie bez GPS),
- NakÅ‚ada na kaÅ¼dÄ… klatkÄ™ wideo strzaÅ‚kÄ™ reprezentujÄ…cÄ… kierunek ruchu ,
- Generuje koÅ„cowy film `.mp4` z naniesionÄ… wizualizacjÄ…,
- Docelowo: integruje rÃ³wnieÅ¼ dane GPS i heading do rysowania rzeczywistej trajektorii.

##  Struktura katalogÃ³w

```
BMWVISION_V1/
â”‚
â”œâ”€â”€ data/                     # dane wejÅ›ciowe â€“ wideo i CSV
â”œâ”€â”€ models/
â”‚   â””â”€â”€ twinlite/             # Model TwinLiteNetPlus i jego konfiguracja
â”‚
â”œâ”€â”€ output/                   # Katalog na wynikowe ramki lub dane poÅ›rednie
â”œâ”€â”€ outputs/                  # Wygenerowane filmy z wizualizacjÄ…
â”‚   â”œâ”€â”€ output_video.mp4
â”‚   â””â”€â”€ output_video_example.mp4
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ segment_utils.py      # Segmentacja drogi â€“ obsÅ‚uga modelu TwinLiteNetPlus
â”‚   â”œâ”€â”€ video_segment.py      # GÅ‚Ã³wne przetwarzanie wideo i rysowanie trajektorii
â”‚   â”œâ”€â”€ sync_gps_video.py     # WstÄ™pna synchronizacja GPS z wideo (przygotowane)
â”‚   â”œâ”€â”€ frame.jpg             # PrzykÅ‚adowa ramka (debug - testowanie segment_utils)
â”‚
â”œâ”€â”€ README.md
â””â”€â”€ .gitignore
```

## Wymagania

- Python 3.8+
- PyTorch
- OpenCV
- NumPy
- Pandas

Instalacja zaleÅ¼noÅ›ci:

```bash
pip install -r requirements.txt
```

### UÅ¼ycie pretrenowanych modeli
Pretrenowany model moÅ¼na pobraÄ‡ z linku: [Modele](https://drive.google.com/drive/folders/1EqBzUw0b17aEumZmWYrGZmbx_XJqU-vz) i umieÅ›ciÄ‡ w katalogu models/twinlite/model/pretrained
##  Uruchomienie

1. UmieÅ›Ä‡ wideo do analizy w katalogu `data/`.
2. Upewnij siÄ™, Å¼e `config.yaml` (jeÅ›li uÅ¼ywany) wskazuje na poprawne Å›cieÅ¼ki.
3. Uruchom gÅ‚Ã³wny skrypt:

```bash
python src/video_segment.py
```

Wynikowy film zostanie zapisany w katalogu `outputs/`.

##  Planowane funkcjonalnoÅ›ci (TODO)

- Synchronizacja i interpolacja danych GPS wzglÄ™dem klatek wideo
- Rysowanie rzeczywistej trajektorii jazdy z uÅ¼yciem wspÃ³Å‚rzÄ™dnych GPS
- Mapowanie danych geograficznych na ukÅ‚ad lokalny XY
-  Automatyczne porÃ³wnanie wykrytej trajektorii z GPS (walidacja)

## ğŸ‘¤ Autorzy

Mariusz Jagosz, Bartosz Bieniek, Dawid Klimek

Segmentacja zostaÅ‚a oparta na modelu TwinLiteNetPlus autorstwa Quang-Huy Che et al., udostÄ™pnionym na licencji MIT.
Repozytorium: https://github.com/chequanghuy/TwinLiteNetPlus
Zobacz publikacjÄ™: https://arxiv.org/abs/2403.16958
